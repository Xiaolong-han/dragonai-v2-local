# DragonAI v2 后端优化方案

## 一、高优先级优化

### 1. 数据库层异步化改造

* 迁移 SQLAlchemy 到异步模式（AsyncSession）

* 使用 `asyncpg` 驱动替代 `psycopg2`

* 更新 `database.py` 为异步连接池

* 改造所有 Service 层为真正的异步方法

### 2. 安全加固

* 添加请求限流（slowapi）

* 收紧 CORS 配置

* 添加请求体大小限制

* 敏感操作审计日志

## 二、中优先级优化

### 3. 可观测性改进

* 添加请求追踪 ID（X-Request-ID）

* 结构化日志输出

* 性能监控端点

### 4. 缓存优化

* 优化缓存键设计

* 缓存预热策略

* 缓存命中率监控

### 5. 测试覆盖率提升

* 补充单元测试

* API 集成测试

* CI/CD 配置

## 三、实施顺序

```
Phase 1: 数据库异步化 + 安全加固
Phase 2: 可观测性 + 缓存优化
Phase 3: 测试完善
```

是否开始实施
